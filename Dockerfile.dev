FROM node:20

WORKDIR /usr/src/app

# Copy package files first
COPY package*.json ./

# Install all dependencies
RUN npm install

# Copy prisma schema and generate client
COPY prisma ./prisma/
RUN npx prisma generate

# We'll mount source code as a volume, so we don't need to copy it here

EXPOSE 8000

# Command to start development server
CMD ["npm", "run", "dev"]